apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: redis
  labels:
    name: redis
  finalizers:
    - resources-finalizer.argocd.argoproj.io
spec:
  project: default
  source:
    repoURL: 'https://github.com/unlikelyPhotocopy/redis'
    path: redis
    targetRevision: HEAD
    helm:
      values: |
        replica:
          spreadConstraints:
            - maxSkew: 1
              topologyKey: kubernetes.io/hostname
              whenUnsatisfiable: DoNotSchedule
              labelSelector:
                matchLabels:
                  app.kubernetes.io/component: replica
                  app.kubernetes.io/instance: redis
                  app.kubernetes.io/name: redis
        volumePermissions:
          enabled: true
        tls:
          autoGenerated: true
        global:
          redis:
            password: 'redis123!'
  destination:
    server: 'https://kubernetes.default.svc'
    namespace: redis
  syncPolicy:
    automated: {}
